---
title : "__`utilitR`__"
subtitle : "Une documentation collaborative sur `R`"
author : "Lino Galiana, Olivier Meslin"
institute : "Insee"
date : "`r format(Sys.time(), '%d %B %Y')`"
output :
  utilitr::utilitr_presentation:
    css: custom.css
    includes :
      after_body : insert-logo.html
---

# Introduction

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

.sauterligne3[
Le projet `utilitR` vise à produire une documentation collaborative sur `R`,
destinée principalement aux agents du Service statistique public (mais pas exclusivement).
]

--
.sauterligne2[
Plan de la présentation :
]

- Présentation du projet ;
- Fonctionnement du projet: panorama ;
- Nos conclusions ;
- Quelques définitions ;
- Pourquoi mettre en place ce type d'approche ;
- Fonctionnement collaboratif d'utilitR ;
    + Git & Github
    + CI/CD



---
# 1. Présentation du projet
## Une démarche collaborative et _open source_

* Projet entièrement _open source_ (`r fontawesome::fa("fab fa-github")` [`InseeFrLab`](https://github.com/InseeFrLab/utilitR)) ;
* Démarche collaborative impliquant __plus de 20 contributeurs__ :
    + dispersés dans toute la France ;
    + issus de plusieurs institutions du SSP.
* Organisation horizontale, sur le modèle de `Wikipedia` :
    + relecture par les pairs ;
    + validation collégiale ;
* Acculturation à des outils favorisant la **reproductibilité** et la **pérennité**, au-delà de l'usage de `r fontawesome::fa("fab fa-r-project")` :
    + `Docker` `r fontawesome::fa("fab fa-docker")` ;
    + `Git` `r fontawesome::fa("fab fa-git-alt")` ;
    + `Github` `r fontawesome::fa("fab fa-github")`.

---
# 1. Présentation du projet
## Des choix techniques au service de la qualité

* Une documentation pensée pour le statisticien :
    + Recommandations adaptées au contexte de travail des agents du service statistique public ;
    + Exemples sur [données réelles Insee](https://www.insee.fr) (grâce au _package_ [`doremifasol`](https://github.com/InseeFrLab/DoReMIFaSol)) ;
    + Documentation entièrement reproductible.

* Processus de publication à l'état de l'art :
    + Plusieurs _outputs_ (site web `r fontawesome::fa("fab fa-firefox")`, livre PDF `r fontawesome::fa("fas fa-file-pdf")`) avec les mêmes codes sources ;
    + Publication automatique à chaque modification des fichiers sources.

* Défis techniques surmontés ont permis des évolutions de l'écosystème `R Markdown` :
    + Solutions bénéficiant à l'ensemble de la communauté `r fontawesome::fa("fab fa-r-project")`.
    + Sur `r fontawesome::fa("fab fa-github")`: [rstudio/rmarkdown#2146](https://github.com/rstudio/rmarkdown/pull/2146), [rstudio/rmarkdown#2145](https://github.com/rstudio/rmarkdown/issues/2145), [rstudio/bookdown#1101](https://github.com/rstudio/bookdown/issues/1101), [rstudio/bookdown#1117](https://github.com/rstudio/bookdown/issues/1117)

<br>

__Le projet `utilitR` est un laboratoire qui préfigure les évolutions des méthodes de travail des statisticiens.__

---
# 1. Présentation du projet
## Méthode de travail : reproductibilité et qualité

Le dépôt `Github` `r fontawesome::fa("fab fa-github")` d'`utilitR` propose :

* Un __environnement informatique complet et reproductible__ pour produire la documentation (image `Docker`) ;
* Des scripts d'**intégration continue** qui vérifient que les contributions ne comportent pas d'erreur de programmation, et que les exemples sont bien reproductibles ;
* Des scripts de **déploiement continu** qui compilent la documentation et déploient le site internet à chaque modification de la branche `master` ;
* Un **site de prévisualisation** (via `Netlify`) sur lequel les contributeurs peuvent voir les modifications qu'ils apportent au site, sans que le site public ne soit modifié.


---
# 1. Présentation du projet
## Diffusion de la documentation

La documentation est diffusée sous trois formes :

- `r fontawesome::fa("fab fa-firefox")` un site internet ([www.utilitr.org](https://www.utilitr.org)) ;
- `r fontawesome::fa("fas fa-print")` chaque fiche est disponible en format A4 sur le site internet ;
- `r fontawesome::fa("fas fa-file-pdf")` l'intégralité de la documentation en format pdf. 

<br> Il est envisagé que le site internet soit actualisé en continu, tandis que la brochure pdf serait publiée de façon ponctuelle et millésimée.



---
# 1. Présentation du projet
## Diffusion de la documentation

La documentation est diffusée sous trois formes :

- `r fontawesome::fa("fab fa-firefox")` un site internet ([www.utilitr.org](https://www.utilitr.org)) ;
- `r fontawesome::fa("fas fa-print")` chaque fiche est disponible en format A4 sur le site internet ;
- `r fontawesome::fa("fas fa-file-pdf")` l'intégralité de la documentation en format pdf. 

<br> Il est envisagé que le site internet soit actualisé en continu, tandis que la brochure pdf serait publiée de façon ponctuelle et millésimée.

<!---- PARTIE XXX ---------------->

---
# 2. Fonctionnement du projet
## Organisation du projet

**Le projet `utilitR` est un projet collaboratif, horizontal, _open source_ et ouvert à tous, auquel tous les agents peuvent contribuer.**

--
* Cinq principes détaillés dans le [manifeste](https://github.com/InseeFrLab/utilitR/blob/master/Manifeste.md) : transparence, ouverture, bienveillance, exigence et reproductibilité.

--

* Organisation sans hiérarchie :
    * Un _groupe de contributeurs_ (environ 20), parmi lesquels deux coordinateurs (Lino Galiana et Olivier Meslin) ;
    * Un _comité de parrainage_ composé de managers : Benoît Rouppert, Arnaud Degorre, Patrick Sillard, Sébastien Roux.
--
* La marche à suivre pour contribuer est détaillée dans le [guide de contribution](https://github.com/InseeFrLab/utilitR/blob/master/CONTRIBUTING.md).

--

**Vous pouvez rejoindre l'équipe de contributeurs à tout moment.**

---
# 2. Fonctionnement du projet
## Méthode de travail : une démarche collaborative et _open source_

Le projet `utilitR` est entièrement développé avec des outils collaboratifs :

- Tous les codes du projet sont stockés sur un dépôt Github ([https://github.com/InseeFrLab/utilitR](lien)) et disponibles sous licence libre ;
- Les travaux sont menés selon les méthodes de développement logiciel (_pull requests_, _issues_) ;
- Toutes les contributions sont soumises à une relecture par les pairs et validées collégialement (sur le modèle de Wikipedia).

---
# 2. Fonctionnement du projet
## Méthode de travail

Le projet `utilitR` utilise des méthodes d'intégration continue à l'état de l'art :

```{r, echo = FALSE}
knitr::include_graphics("./resources/githubCI.png")
```


---
# 3. Quelles sont nos conclusions ?
## Git `r fontawesome::fa("fab fa-git-alt")` + Github `r fontawesome::fa("fab fa-github")`: un **écosystème efficace**

* une __unique source de vérité__ avec au même endroit:
    + le contenu validé ;
    + le contenu en cours de rédaction ;
* **pas de mail** pour s'échanger des fichiers ou des informations ;
* organiser le travail collaboratif de façon **ouverte** et **transparente** :
    + tout le monde peut proposer des modifications (de la correction de coquille à la rédaction d'une fiche) ;
    + tout le monde peut donner son avis.

* **Pas besoin d'être un expert `Git`** pour contribuer à un projet collaboratif
    + Besoin d'un ou deux facilitateurs ou coach `Git` ;
    + Intérêt d'avoir une messagerie instantanée `r fontawesome::fa("fas fa-comment")` en complément ;
    + Proposer des modalités de contribution facilitées (bouton *Edit this page* `r fontawesome::fa("fab fa-github")` sur le site)
    + Informations importantes à archiver dans le projet, pas dans une boîte mail

---
# 3. Quelles sont nos conclusions ?
## Git `r fontawesome::fa("fab fa-git-alt")` + Github `r fontawesome::fa("fab fa-github")`: **cela ne suffit pas**

* Il faut de la **communication**.
* Besoin d'un outil de communication collaboratif en parallèle
    + Tchap
* Permet de faire circuler l'information :
    + publication nouvelle fiche
    + besoin relecteur ou rédacteur+
    + *debug*
    + blagues...

    
---
# 3. Quelles sont nos conclusions ?
## Résultats

* traçabilité parfaite ;
* simplicité de mise à jour ;
* ouverture ;
* collaboration renforcée ;
* fiabilité du processus de publication ;
* projet plus pérenne

<br>
__On peut faire des trucs de fou avec Rmardown associé à Git + Github/Gitlab : un site web et un livre de 350 pages avec les mêmes fichiers sources__


<!---- PARTIE XXX ---------------->


<!---- PARTIE XXX ---------------->


---
# 3. Quelques définitions
## Définitions

|                        |  |
|------------------------|--|
| Git                    |  |
| Github                 |  |
| Branches               |  |
| Pull request           |  |
| Github Flow            |  |
| Conteneur              |  |
| Intégration continue   |  |
| CI/CD                  |  |
| devops                 |  |




---
# 5. Quelle collaboration sur Github ?

---
# 6. Intégration continue

## Pourquoi faire de l'intégration continue ?

```{r, echo = FALSE, out.width="50%", fig.show="hold"}
knitr::include_graphics("https://crowdspotsimages.s3-us-west-2.amazonaws.com/user-content/LcYPp_4UQjuu44T_RXp8qg.jpeg")
knitr::include_graphics("https://flexagon.com/wp-content/uploads/2020/04/a-world-without-ci.cd-meme.jpg")
```

Sources :

* `https://crowdspotsimages.s3-us-west-2.amazonaws.com/user-content/LcYPp_4UQjuu44T_RXp8qg.jpeg`
* `https://flexagon.com/wp-content/uploads/2020/04/a-world-without-ci.cd-meme.jpg`

--

L'automatisation de ces processus présente de multiples avantages :

+ elle allège le travail des coordinateurs et des contributeurs ;
+ elle assure un environnement plus reproductible et facilite le repérage des erreurs ;
+ elle permet aux contributeurs d'ignorer les détails techniques de la production de la documentation et de se concentrer uniquement sur le fond.


---
# 6. Intégration continue
## `R Markdown`, *un langage pour les gouverner tous*

<!-- en un site web ou un PDF cohérent (gestion des numéros de chapitre, des -->
<!-- liens entre fiches, etc.) -->

<!-- (`.Rmd` ➜ `.md` ➜ `.html`) ; -->
<!-- (`.md` ➜ `.html` ➜ `.pdf`) ; -->

* Les codes sources de la documentation prennent la forme de fichiers `R Markdown`, qui rassemblent les textes et les exemples de codes ;
* `R` compile ces codes sources de deux manières :
    + Production d'un site internet grâce au _package_ `blogdown` ;
    + Production d'un livre en format A4 grâce au _package_ `pagedown` ;
    + De plus, l'utilisation de `paged.js` permet de transformer chaque page du site internet en un chapitre paginé prêt à être imprimé.
* Les modèles de document reposent sur les technologies Web standards (CSS et Javascript) et sont organisés sous la forme d'un _package_.

--

<br>
* Avantages :
    + le livre et le site web sont générés à partir des mêmes codes sources ;
    + L'utilisation des outils technologies Web permet de ne pas utiliser `LaTeX` ;
    + Le projet `utilitR` a induit des évolutions de l'écosystème `R Markdown` qui bénéficient à de nombreux utilisateurs.



---
# Où en est le projet aujourd'hui ?

* Un portail d'accès sous forme de site *web* :
    + La documentation principale est disponible sur [www.book.utilitr.org](www.book.utilitr.org) ;
    + Guide des bonnes pratiques en `R` disponible sur [www.pratiques.utilitr.org](www.pratiques.utilitr.org).

* Un point d'entrée: <https://www.utilitr.org>
---
# Remerciements

<!-- Le projet `utilitR` est un projet collaboratif qui a bénéficié des contributions de :  -->
<!-- r paste0(paste(format(Filter(function(x) !("cph" %in% x$role), desc::desc_get_authors()), include = c("given", "family")), collapse = ", "), ".") -->

.small90[
.auteurs[

Contributeurs : Raphaële Adjerad, Mathias André, Pierre-Yves Berrard, Lionel Cacheux, Arthur Cazaubiel, Sylvain Daubrée, Arlindo Dos Santos, Alexis Eidelman, Marie-Emmanuelle Faure, Gilles Fidani, Lino Galiana, Gaëlle Genin, Pierre Lamarche, Claire Legroux, Romain Lesur, Jean-Daniel Lomenède, Pascal Mercier, Olivier Meslin, Géraldine Rochambeau, Milena Suarez Castillo, Cédric Tassart.

Coordination : Lino Galiana et Olivier Meslin.

Comité de parrainage : Arnaud Degorre, Benoît Rouppert, Patrick Sillard et Sébastien Roux pour leur soutien.

Logo : Anna Schlaifer.

Les contributeurs remercient Julien Taquet et Marc Hufschmitt pour leur aide précieuse sur la mise en forme du site et de la brochure.
]
]

---
background-image: url('resources/logo-utilitr.png')
background-size: 7cm
background-position: 8.5cm 3cm

# Merci !
